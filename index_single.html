<html>
  <head>
    <title>Dubai Expo - Single Screen</title>
    <meta name="description" content="Multiple Markers - A-Frame School">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/aframe/0.6.0/aframe-master.min.js"></script>

    <style type="text/css">
      #video-permission {
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background: white;
          z-index: 10000;
          display: none;
      }
      #video-permission-button {
        position: fixed;
        top: calc(50% - 1em);
        left: calc(50% - 60px);
        width: 120px;
        height: 2em;
      }
    </style>

    <script>
      var AVideoPlayer = function() {

      this._mobileFriendly = function() {
        var vid1Src = document.getElementById("adv_video_src");
        var vid2Src = document.getElementById("mon_video_src");
        if (AFRAME.utils.device.isMobile()) {
          var that = this;
          let video_permission        = document.getElementById('video-permission');
          let video_permission_button = document.getElementById('video-permission-button');

          video_permission.style.display = 'block';
          video_permission_button.addEventListener("click", function() {
            video_permission.style.display = 'none';
            vid1Src.play();
            vid2Src.play();
          }, false);
        }else{
          vid1Src.play();
          vid2Src.play();
        }

      }

      this.init = function() {
        this._mobileFriendly();
      }
      this.init();
     }

      </script>

  </head>
  <body>
    <div id="video-permission">
     <button id="video-permission-button">Allow VR video</button>
   </div>
      <a-scene>
        <a-assets>

          <img id="skynew" src="datasinglescreen/sky/sky.jpg">
          <video id="adv_video_src" src="datasinglescreen/advertisement.mp4" ></video>
          <video id="mon_video_src" src="datasinglescreen/monitoring.mp4" /></video>
          <a-asset-item id="atm-obj" src="datasinglescreen/atm/atm.obj"></a-asset-item>
      		<a-asset-item id="atm-mtl" src="datasinglescreen/atm/atm.mtl"></a-asset-item>
          <a-asset-item id="robot-obj" src="datasinglescreen/robot/robot.obj"></a-asset-item>
      		<a-asset-item id="robot-mtl" src="datasinglescreen/robot/robot.mtl"></a-asset-item>
        </a-assets>
        <a-sky src="#skynew"></a-sky>

          <a-text font="kelsonsans" value="Welcome" width="6" position="-0.5 2.8 -4"  align="center"></a-text>
          <a-text font="kelsonsans" value="To" width="6" position="-0.5 2.5 -4"   align="center"></a-text>
          <a-text font="kelsonsans" value="Dubai Expo Test Lab" width="6" position="-0.5 2.2 -4"   align="center"></a-text>

          <a-text font="kelsonsans" value="Advertisement Area" width="3" position="3 2.5 0" rotation="0 -95 0" align="center" ></a-text>
          <a-video src="#adv_video_src" width="0.7" height="0.39" position="1.3 1.7 0" loop="true" id="adv_video"  rotation="0 -90 0"></a-video>
          <a-entity obj-model="obj: #atm-obj; mtl: #atm-mtl"  scale="0.3 0.3 0.3" position="9 0 -4" rotation="0 0 0"></a-entity>
          <a-entity obj-model="obj: #robot-obj; mtl: #robot-mtl"  scale="0.6 0.6 0.6" position="6 0 -4" rotation="0 -45 0">
            <a-animation attribute="rotation"
             dur="10000"
             fill="forwards"
             to="0 360 0"
             repeat="indefinite"></a-animation>
          </a-entity>


          <a-text font="kelsonsans" value="Monitoring Area" width="3" position="-3 2 0" rotation="0 95 0" align="center" ></a-text>
          <a-video src="#mon_video_src" width="2" height="1" rotation="0 95 0" position="-5 1.6 0"  loop="true" id="mon_video"></a-video>

        <a-entity camera="userHeight: 1.6" look-controls wasd-controls-enabled mouse-cursor>
            <a-entity position="0 0 -3" scale="0.2 0.2 0.2"  geometry="primitive: ring; radiusOuter: 0.20;radiusInner: 0.10;" material="color: #990000; shader: flat" cursor="maxDistance: 30; fuse: true">
                <a-animation begin="click" easing="ease-in" attribute="scale" fill="backwards" from="0.1 0.1 0.1" to="1 1 1" dur="150"></a-animation>
                <a-animation begin="fusing"  easing="ease-in" attribute="scale" fill="forwards" from="1 1 1" to="0.2 0.2 0.2" dur="1500"></a-animation>
            </a-entity>
        </a-entity>
      </a-scene>
    </body>
    <script>
    var videoPlayer = new AVideoPlayer();
    </script>
</html>
