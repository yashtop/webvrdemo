<html>
  <head>
    <title>Multiple Markers - A-Frame School</title>
    <meta name="description" content="Multiple Markers - A-Frame School">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/aframe/0.6.0/aframe-master.min.js"></script>

    <style type="text/css">
      #video-permission {
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background: white;
          z-index: 10000;
          display: none;
      }
      #video-permission-button {
        position: fixed;
        top: calc(50% - 1em);
        left: calc(50% - 60px);
        width: 120px;
        height: 2em;
      }
    </style>

    <script>
      var AVideoPlayer = function() {
      /**
      * MOBILE PATCH TO PLAY VIDEO
      */
      this._mobileFriendly = function() {
        if (AFRAME.utils.device.isMobile()) {
          var that = this;
          let video_permission        = document.getElementById('video-permission');
          let video_permission_button = document.getElementById('video-permission-button');

          video_permission.style.display = 'block';
          video_permission_button.addEventListener("click", function() {
            video_permission.style.display = 'none';
            var vid1Src = document.getElementById("sky2_video_src");
            var vid2Src = document.getElementById("sky3_video1_src");
            vid1Src.play();
            vid1Src.pause();
            vid2Src.play();
            vid2Src.pause();
          }, false);
        }
      }
      this.init = function() {
        this._mobileFriendly();
      }
      this.init();
     }
      AFRAME.registerComponent('set-sky', {
        schema: {default:''},
        init() {
        this.el.addEventListener('click', () => {
    		var sky = document.getElementById(this.el.id);
        var skySrc = sky.id.replace('_thumb','');
        var vid1 = document.getElementById("sky2_video");
        var vid2 = document.getElementById("sky3_video1");
        var vid1Src = document.getElementById("sky2_video_src");
        var vid2Src = document.getElementById("sky3_video1_src");
        var thumb1 = document.getElementById("sky1_thumb");
        var thumb2 = document.getElementById("sky2_thumb");
        var thumb3 = document.getElementById("sky3_thumb");
        var thumb4 = document.getElementById("sky4_thumb");
        switch(skySrc){
          case 'sky1':
          vid1.setAttribute('visible',false );
          vid2.setAttribute('visible',false );
          thumb1.setAttribute('rotation',{'x':0,'y':0,'z':0});
          thumb2.setAttribute('rotation',{'x':0,'y':0,'z':0});
          thumb3.setAttribute('rotation',{'x':0,'y':0,'z':0});
          thumb4.setAttribute('rotation',{'x':0,'y':0,'z':0});
          thumb1.setAttribute('position',{'x':-2,'y':2,'z':-4});
          thumb2.setAttribute('position',{'x':-2,'y':1.4,'z':-4});
          thumb3.setAttribute('position',{'x':-2,'y':0.8,'z':-4});
          thumb4.setAttribute('position',{'x':-2,'y':0.2,'z':-4});
          vid1Src.pause();
          vid2Src.pause();
          break;
          case 'sky2':
          vid1.setAttribute('visible',true );
          thumb1.setAttribute('rotation',{'x':0,'y':-45,'z':0});
          thumb2.setAttribute('rotation',{'x':0,'y':-45,'z':0});
          thumb3.setAttribute('rotation',{'x':0,'y':-45,'z':0});
          thumb4.setAttribute('rotation',{'x':0,'y':-45,'z':0});
          thumb1.setAttribute('position',{'x':5,'y':1.5,'z':-4});
          thumb2.setAttribute('position',{'x':5,'y':0.9,'z':-4});
          thumb3.setAttribute('position',{'x':5,'y':0.3,'z':-4});
          thumb4.setAttribute('position',{'x':5,'y':-0.3,'z':-4});
          vid1Src.play();
          vid2.setAttribute('visible',false );
          vid2Src.pause();
          break;
          case 'sky3':
          vid1.setAttribute('visible',false );
          vid2.setAttribute('visible',true );
          thumb1.setAttribute('rotation',{'x':0,'y':0,'z':0});
          thumb2.setAttribute('rotation',{'x':0,'y':0,'z':0});
          thumb3.setAttribute('rotation',{'x':0,'y':0,'z':0});
          thumb4.setAttribute('rotation',{'x':0,'y':0,'z':0});
          thumb1.setAttribute('position',{'x':-2,'y':2,'z':-4});
          thumb2.setAttribute('position',{'x':-2,'y':1.4,'z':-4});
          thumb3.setAttribute('position',{'x':-2,'y':0.8,'z':-4});
          thumb4.setAttribute('position',{'x':-2,'y':0.2,'z':-4});
          vid1Src.pause();
          vid2Src.play();
          break;
          case 'sky4':
          vid1.setAttribute('visible',false );
          vid2.setAttribute('visible',false );
          thumb1.setAttribute('rotation',{'x':0,'y':-45,'z':0});
          thumb2.setAttribute('rotation',{'x':0,'y':-45,'z':0});
          thumb3.setAttribute('rotation',{'x':0,'y':-45,'z':0});
          thumb4.setAttribute('rotation',{'x':0,'y':-45,'z':0});
          thumb1.setAttribute('position',{'x':3.5,'y':1,'z':-4});
          thumb2.setAttribute('position',{'x':3.5,'y':0.4,'z':-4});
          thumb3.setAttribute('position',{'x':3.5,'y':-0.2,'z':-4});
          thumb4.setAttribute('position',{'x':3.5,'y':-0.8,'z':-4});
          vid1Src.pause();
          vid2Src.pause();
          break;

        }
    		document.getElementById("skymain").setAttribute('src','#'+skySrc );

          });
        }
      });
      </script>

  </head>
  <body>
    <div id="video-permission">
     <button id="video-permission-button">Allow VR video</button>
   </div>
      <a-scene>
        <a-assets>
          <img id="thumb1" src="data/thumb_1.png" crossorigin="anonymous" />
          <img id="thumb2" src="data/thumb_2.png" crossorigin="anonymous" />
          <img id="thumb3" src="data/thumb_3.png" crossorigin="anonymous" />
          <img id="thumb4" src="data/thumb_4.png" crossorigin="anonymous" />
          <img id="sky1" src="data/sky_1.jpg" crossorigin="anonymous" />
          <img id="sky2" src="data/sky_2.jpg" crossorigin="anonymous" />
          <img id="sky3" src="data/sky_3.jpg" crossorigin="anonymous" />
          <img id="sky4" src="data/sky_4.jpg" crossorigin="anonymous" />
          <video id="sky2_video_src" src="data/sky2_video.mp4" ></video>
          <video id="sky3_video1_src" src="data/sky3_video1.mp4" /></video>
        </a-assets>
        <a-sky src="#sky1" rotation="0 -100 0" id="skymain"></a-sky>
        <a-video src="#sky2_video_src" width="2.5" height="1.7" position="2.7 0.3 -4" visible="false" id="sky2_video"></a-video>
        <a-video src="#sky3_video1_src" width="3" height="2" position="0.5 0.5 -4" visible="false" id="sky3_video1"></a-video>

       <!-- <a-video src="video.mp4" width="2.5" height="3.5" position="1.7 3.4 -4" visible="false" id="vidiconobj"></a-video>
        <a-image id="imageiconobj" src="imageiconobj.jpg" width="2.5" height="3.5" id="vidicon" position="1.7 3.4 -4" visible="false"></a-image>
         <a-image id="anaiconobj" src="imageicon1.jpg" width="2.5" height="3.5" id="vidicon" position="1.7 3.4 -4" visible="false"></a-image>
        <a-collada-model src="#tree" rotation="0 45 0" position="1.7 2.5 -4" scale="0.5 0.5 0.5"  collada-model="" id="3diconobj" visible="false">

        </a-collada-model>
        <a-animation attribute="position" from="0 0 0" to="2 4 -8"><a-text font="kelsonsans" value="Welcome" width="6" position="-2.5 0.25 -1.5" rotation="0 15 0"></a-text></a-animation>
-->
        <a-image src="#thumb1" width="1" height="0.5" id="sky1_thumb" position="-2 2 -4"  set-sky></a-image>
        <a-image src="#thumb2" width="1" height="0.5" id="sky2_thumb" position="-2 1.4 -4" set-sky></a-image>
        <a-image src="#thumb3" width="1" height="0.5" id="sky3_thumb" position="-2 0.8 -4" set-sky></a-image>
        <a-image src="#thumb4" width="1" height="0.5" id="sky4_thumb" position="-2 0.2 -4" set-sky></a-image>
          <a-entity position="0.1 0.1 0.5">
           <a-entity camera look-controls wasd-controls>
               <a-entity position="0 0 -3" scale="0.2 0.2 0.2"  geometry="primitive: ring; radiusOuter: 0.20;radiusInner: 0.10;" material="color: #990000; shader: flat" cursor="maxDistance: 30; fuse: true">
                   <a-animation begin="click" easing="ease-in" attribute="scale" fill="backwards" from="0.1 0.1 0.1" to="1 1 1" dur="150"></a-animation>
                   <a-animation begin="fusing" easing="ease-in" attribute="scale" fill="forwards" from="1 1 1" to="0.2 0.2 0.2" dur="1500"></a-animation>
               </a-entity>
           </a-entity>
       </a-entity>
      </a-scene>
    </body>
    <script>
    var videoPlayer = new AVideoPlayer();
    </script>
</html>
